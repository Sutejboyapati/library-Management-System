import{a as B,b as P,c as V,d as W,e as L,f as F,g as O,h as T,i as N,j as A}from"./chunk-OOQXQIKY.js";import{a as I}from"./chunk-RTNBUYP5.js";import{A as h,B as x,F as _,I as M,K as b,N as i,O as n,Q as k,R as y,S as d,T as l,U as f,V as S,X as c,Y as u,Z as p,oa as w,qa as v,ra as E,s as m,t as g,y as a}from"./chunk-OW66QSYT.js";function q(s,C){s&1&&(i(0,"p",2),l(1,"Loading..."),n())}function z(s,C){if(s&1&&(i(0,"p",18),l(1),n()),s&2){let e=d(2);a(),f(e.error)}}function R(s,C){if(s&1){let e=k();i(0,"form",3),y("ngSubmit",function(){m(e);let t=d();return g(t.onSubmit())}),i(1,"label",4),l(2,"Title *"),n(),i(3,"input",5),p("ngModelChange",function(t){m(e);let r=d();return u(r.title,t)||(r.title=t),g(t)}),n(),i(4,"label",6),l(5,"Author *"),n(),i(6,"input",7),p("ngModelChange",function(t){m(e);let r=d();return u(r.author,t)||(r.author=t),g(t)}),n(),i(7,"label",8),l(8,"ISBN"),n(),i(9,"input",9),p("ngModelChange",function(t){m(e);let r=d();return u(r.isbn,t)||(r.isbn=t),g(t)}),n(),i(10,"label",10),l(11,"Genre"),n(),i(12,"input",11),p("ngModelChange",function(t){m(e);let r=d();return u(r.genre,t)||(r.genre=t),g(t)}),n(),i(13,"label",12),l(14,"Language"),n(),i(15,"input",13),p("ngModelChange",function(t){m(e);let r=d();return u(r.language,t)||(r.language=t),g(t)}),n(),i(16,"label",14),l(17,"Shelf number"),n(),i(18,"input",15),p("ngModelChange",function(t){m(e);let r=d();return u(r.shelf_number,t)||(r.shelf_number=t),g(t)}),n(),i(19,"label",16),l(20,"Available copies"),n(),i(21,"input",17),p("ngModelChange",function(t){m(e);let r=d();return u(r.available_copies,t)||(r.available_copies=t),g(t)}),n(),_(22,z,2,1,"p",18),i(23,"div",19)(24,"button",20),l(25),n(),i(26,"a",21),l(27,"Cancel"),n()()()}if(s&2){let e=d();a(3),c("ngModel",e.title),a(3),c("ngModel",e.author),a(3),c("ngModel",e.isbn),a(3),c("ngModel",e.genre),a(3),c("ngModel",e.language),a(3),c("ngModel",e.shelf_number),a(3),c("ngModel",e.available_copies),a(),b(e.error?22:-1),a(2),M("disabled",e.submitLoading),a(),S(" ",e.submitLoading?"Saving...":e.isEdit?"Update":"Add book"," ")}}var K=(()=>{class s{constructor(e,o,t){this.route=e,this.router=o,this.bookService=t,this.isEdit=!1,this.id=null,this.title="",this.author="",this.isbn="",this.genre="",this.language="English",this.shelf_number="",this.available_copies=1,this.loading=!1,this.submitLoading=!1,this.error=""}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.isEdit=!0,this.id=Number(e),Number.isNaN(this.id)||this.loadBook())}loadBook(){this.id!=null&&(this.loading=!0,this.bookService.getBook(this.id).subscribe({next:e=>{this.title=e.title??"",this.author=e.author??"",this.isbn=e.isbn??"",this.genre=e.genre??"",this.language=e.language??"English",this.shelf_number=e.shelf_number??"",this.available_copies=e.available_copies??1},error:()=>this.router.navigate(["/main/admin/books"]),complete:()=>this.loading=!1}))}onSubmit(){if(this.error="",!this.title.trim()){this.error="Title is required.";return}if(!this.author.trim()){this.error="Author is required.";return}let e={title:this.title.trim(),author:this.author.trim(),isbn:this.isbn.trim()||void 0,genre:this.genre.trim()||void 0,language:this.language.trim()||void 0,shelf_number:this.shelf_number.trim()||void 0,available_copies:this.available_copies};this.submitLoading=!0,this.isEdit&&this.id!=null?this.bookService.updateBook(this.id,e).subscribe({next:()=>this.router.navigate(["/main/admin/books"]),error:o=>{this.error=o?.error?.message??o?.message??"Update failed.",this.submitLoading=!1},complete:()=>this.submitLoading=!1}):this.bookService.addBook(e).subscribe({next:()=>this.router.navigate(["/main/admin/books"]),error:o=>{this.error=o?.error?.message??o?.message??"Add failed.",this.submitLoading=!1},complete:()=>this.submitLoading=!1})}static{this.\u0275fac=function(o){return new(o||s)(h(w),h(v),h(I))}}static{this.\u0275cmp=x({type:s,selectors:[["app-book-form"]],decls:7,vars:2,consts:[[1,"book-form"],["routerLink","/main/admin/books",1,"back-link"],[1,"loading"],[3,"ngSubmit"],["for","title"],["id","title","type","text","name","title","required","",3,"ngModelChange","ngModel"],["for","author"],["id","author","type","text","name","author","required","",3,"ngModelChange","ngModel"],["for","isbn"],["id","isbn","type","text","name","isbn",3,"ngModelChange","ngModel"],["for","genre"],["id","genre","type","text","name","genre",3,"ngModelChange","ngModel"],["for","language"],["id","language","type","text","name","language",3,"ngModelChange","ngModel"],["for","shelf"],["id","shelf","type","text","name","shelf_number",3,"ngModelChange","ngModel"],["for","copies"],["id","copies","type","number","min","0","name","available_copies",3,"ngModelChange","ngModel"],[1,"error-message"],[1,"form-actions"],["type","submit",3,"disabled"],["routerLink","/main/admin/books",1,"btn-cancel"]],template:function(o,t){o&1&&(i(0,"div",0)(1,"a",1),l(2,"\u2190 Back to books"),n(),i(3,"h2"),l(4),n(),_(5,q,2,0,"p",2)(6,R,28,10,"form"),n()),o&2&&(a(4),f(t.isEdit?"Edit book":"Add book"),a(),b(t.loading?5:6))},dependencies:[A,F,B,O,P,V,N,T,L,W,E],styles:[".back-link[_ngcontent-%COMP%]{display:inline-block;margin-bottom:1rem;font-size:.9rem;color:#0021a5}.book-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1.5rem}.book-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;margin-bottom:.35rem}.book-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:8px 12px;border:1px solid #ccc;border-radius:6px;margin-bottom:1rem}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:1.5rem}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;background:#ff4813;color:#fff;border:none;border-radius:6px;font-size:1rem}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:#e63e0a}.btn-cancel[_ngcontent-%COMP%]{padding:10px 20px;color:#555;border:1px solid #ccc;border-radius:6px;text-decoration:none;display:inline-block}.btn-cancel[_ngcontent-%COMP%]:hover{background:#f5f5f5}.loading[_ngcontent-%COMP%]{color:#666}"]})}}return s})();export{K as BookFormComponent};
