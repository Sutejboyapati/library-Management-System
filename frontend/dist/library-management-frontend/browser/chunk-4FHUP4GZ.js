import{a as E}from"./chunk-RTNBUYP5.js";import{$ as M,A as _,B as x,F as k,I as c,K as p,L as f,M as u,N as i,O as n,Q as h,R as C,S as m,T as o,U as s,V as v,ra as S,s as g,t as b,y as r}from"./chunk-OW66QSYT.js";var y=e=>["/main/admin/books/edit",e],P=(e,l)=>l.id;function A(e,l){if(e&1&&(i(0,"p",3),o(1),n()),e&2){let t=m();r(),s(t.message)}}function B(e,l){e&1&&(i(0,"p",4),o(1,"Loading..."),n())}function L(e,l){e&1&&(i(0,"p",5),o(1,"No books. "),i(2,"a",7),o(3,"Add one"),n(),o(4,"."),n())}function w(e,l){if(e&1){let t=h();i(0,"tr")(1,"td"),o(2),n(),i(3,"td"),o(4),n(),i(5,"td"),o(6),n(),i(7,"td"),o(8),n(),i(9,"td")(10,"a",8),o(11,"Edit"),n(),i(12,"button",9),C("click",function(){let d=g(t).$implicit,O=m(2);return b(O.deleteBook(d))}),o(13),n()()()}if(e&2){let t,a=l.$implicit,d=m(2);r(2),s(a.title),r(2),s(a.author),r(2),s(a.available_copies),r(2),s((t=a.genre)!==null&&t!==void 0?t:"\u2013"),r(2),c("routerLink",M(7,y,a.id)),r(2),c("disabled",d.deleteLoading===a.id),r(),v(" ",d.deleteLoading===a.id?"Deleting...":"Delete"," ")}}function T(e,l){if(e&1&&(i(0,"table",6)(1,"thead")(2,"tr")(3,"th"),o(4,"Title"),n(),i(5,"th"),o(6,"Author"),n(),i(7,"th"),o(8,"Available"),n(),i(9,"th"),o(10,"Genre"),n(),i(11,"th"),o(12,"Actions"),n()()(),i(13,"tbody"),f(14,w,14,9,"tr",null,P),n()()),e&2){let t=m();r(14),u(t.books)}}var F=(()=>{class e{constructor(t){this.bookService=t,this.books=[],this.loading=!1,this.deleteLoading=null,this.message=""}ngOnInit(){this.load()}load(){this.loading=!0,this.bookService.getBooks().subscribe({next:t=>{this.books=Array.isArray(t)?t:[]},error:()=>{this.books=[]},complete:()=>this.loading=!1})}deleteBook(t){confirm(`Delete "${t.title}"?`)&&(this.message="",this.deleteLoading=t.id,this.bookService.deleteBook(t.id).subscribe({next:()=>{this.message="Book deleted.",this.load()},error:a=>{this.message=a?.error?.message??a?.message??"Delete failed."},complete:()=>this.deleteLoading=null}))}static{this.\u0275fac=function(a){return new(a||e)(_(E))}}static{this.\u0275cmp=x({type:e,selectors:[["app-admin-books"]],decls:10,vars:2,consts:[[1,"admin-books"],[1,"page-header"],["routerLink","/main/admin/books/new",1,"btn-primary"],[1,"message"],[1,"loading"],[1,"empty"],[1,"books-table"],["routerLink","/main/admin/books/new"],[1,"btn-link",3,"routerLink"],["type","button",1,"btn-danger",3,"click","disabled"]],template:function(a,d){a&1&&(i(0,"div",0)(1,"div",1)(2,"h2"),o(3,"Manage books"),n(),i(4,"a",2),o(5,"Add book"),n()(),k(6,A,2,1,"p",3)(7,B,2,0,"p",4)(8,L,5,0,"p",5)(9,T,16,0,"table",6),n()),a&2&&(r(6),p(d.message?6:-1),r(),p(d.loading?7:d.books.length===0?8:9))},dependencies:[S],styles:[".page-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem}.btn-primary[_ngcontent-%COMP%]{padding:8px 16px;background:#ff4813;color:#fff;border-radius:6px;font-size:.9rem;text-decoration:none;display:inline-block}.btn-primary[_ngcontent-%COMP%]:hover{background:#e63e0a}.books-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.books-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .books-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid #e9ecef}.books-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;color:#333;background:#f8f9fa}.btn-link[_ngcontent-%COMP%]{margin-right:12px;color:#0021a5;font-size:.9rem}.btn-danger[_ngcontent-%COMP%]{padding:4px 10px;background:#dc3545;color:#fff;border:none;border-radius:4px;font-size:.85rem;cursor:pointer}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#c82333}.btn-danger[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.loading[_ngcontent-%COMP%], .empty[_ngcontent-%COMP%]{color:#666;margin:1rem 0}.message[_ngcontent-%COMP%]{margin-bottom:1rem}"]})}}return e})();export{F as AdminBooksComponent};
